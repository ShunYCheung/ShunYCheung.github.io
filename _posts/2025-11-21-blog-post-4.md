---
title: 'Is normalising flows the future?'
date: 2025-11-22
permalink: /posts/2025/11/normalising_flows/
tags:
  - Normalising flows
  - Code
---


In the field of Gravitational-Wave astronomy, I see a transition from traditional stochastic sampling methods such as Monte Carlo Markov Chains and nested sampling towards something called *normalising flows*. As our inference problems become harder due to the increasing volume of data, we need faster inference methods. In this blog post, we will go through what is a normalising flow and can it solve inference problem that are intractably long for traditional methods. 

A normalising flows works by transforming a simple probabilty distribution (usually a Gaussian distribution) into a more complex distribution through a sequence of mappings. Let $$X$$ be a random variable with a tractable probability density function $$p_X$$. We want to transform this distribution $$p_X$$ (source distribution) into distribution $$p_Y$$ (target distribution) using an invertible (bijective) function $$g$$ where

$$\begin{align}
Y = g(X).
\end{align}$$

We can also transform $$p_Y$$ back into $$p_X$$ using the inverse function $$g^{-1}$$. 


## Change of variables

If we want to figure out the probability value close to a particular Y value, we look at the area under a small interval $$dx$$. We can do something similar for X. 

$$\begin{align}
p_Y(y)|dy| = p_X(x)|dx|
\end{align}$$

$$\begin{align}
p_Y(y) = p_X(x)|\frac{dx}{dy}|
\end{align}$$

$$\begin{align}
p_Y(y) = p_X(x)|\frac{dy}{dx}|^{-1}
\end{align}$$

substituting $$x$$ with the inverse function $$g^{-1}(y)=x$$, we have the formula

$$\begin{equation}
p_Y(y) = p_X(g^{-1}(y))\left|\frac{d g^{-1}(x)}{d x}\right|
\end{equation}$$

**In progress**

# References
- [Normalizing Flows: An Introduction and Review of Current Methods](https://arxiv.org/abs/1908.09257), Ivan *et al.* (2019)

